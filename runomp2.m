% RUNOMP2.M: Start GUI page for OMP analysis main program version 2
%      
% This is the start page for an easy-to-handle package for the use of 
% OMP analysis to resolve fractions of water masses involved in the
% mixing of water masses at a given point in the ocean. The original
% version was prepared by Johannes Karstensen. This version incorporates
% improvements by Matthias Tomczak.
%
% This program will run without any changes, using the default settings
% supplied for all necessary input, and produce output based on
% the data file testdata.mat supplied with this package. For details
% see the README.ps or README.html files.
%
% Some preparation work is necessary if you want to use the program with
% your own data and water type definitions. Again, details can be found
% in the README.ps or README.html files.
%
%---------------------------------------------
% This program is part of the OMP package from:
% GEOMAR
% Helmholtz Centre for Ocean Res. Kiel  FIAMS, Flinders University
% J. Karstensen                         Matthias Tomczak
% Duesternbrooker Weg 20				GPO Box 2100
% 24106 Kiel                            Adelaide, SA
% Germany                               Australia
%
% BUGS: jkarstensen@geomar.de
%   or  matthias.tomczak@flinders.edu.au
%--------------------------------------------

clear all
close all
global ftm ftz fts
fontset;
                    
h1 = ['                           OMP Analysis version  2.0'];
h2 = [''];
h3 = ['                              Johannes Karstensen'];
h4 = ['                                        and'];
h5 = ['                                Matthias Tomczak'];
h6 = [''];
h7 = ['  This is an updated version of a program package for the use'];
h8 = ['  of OMP analysis to resolve fractions of water masses involved'];
h9 = ['  in the mixing of water masses at a given point in the ocean.'];
ht1 = str2mat(h1,h2,h3,h4,h5,h6,h7,h8,h9);

h1 = [''];
h3 = ['  The original version was prepared by Johannes Karstensen.'];
h4 = ['  This version incorporates improvements by Matthias Tomczak.'];
h5 = [''];
h6 = ['                                    August 1999'];
ht2 = str2mat(h1,h2,h3,h4,h5,h6);

h1 = [''];
h2 = [''];
h3 = [''];
h4 = ['       OMP Analysis version 2.0 by Johannes Karstensen and Matthias Tomczak'];
ht3 = str2mat(h1,h2,h3,h4);


h1 = ['  Credits:'];
h2 = [''];
h3 = ['  Version 1 by Johannes Karstensen (Institut fuer Meereskunde an der Universitaet Hamburg, Germany)'];
h4 = ['  email: karstens@ifm.uni-hamburg.de'];
h5 = ['  Version 2.0 by Johannes Karstensen and Matthias Tomczak (FIAMS, Flinders University, Adelaide, Australia)'];
h6 = ['  email: karstens@ifm.uni-hamburg.de  or  matthias.tomczak@flinders.edu.au'];
h7 = ['  Seawater routines from the Seawater toolbox of Phillip P. Morgan, CSIRO Marine Research'];
h8 = [''];
credit = str2mat(h1,h2,h3,h4,h5,h6,h7,h8);

dist = [0.:10.:400.];
atllat = [-47.5:1.:5.5];
dens = [ ...
25.0701 25.8411 26.3199 25.2659 25.9282 26.4029 25.3578 ...
26.0522 26.3544 24.8745 25.4084 25.8643 26.4181 24.8720 ...
25.6122 25.8222 26.3165 26.4470 25.0332 25.9125 26.0903 ...
26.4659 26.9230 25.6837 26.2125 26.5354 26.9400 25.0993 ...
25.8499 26.3073 26.5552 25.5995 25.8337 25.9026 26.5401 ...
24.9697 25.6826 26.1029 26.4618 25.3303 25.8925 26.3766 ...
25.5182 26.1000 26.3729 25.4825 25.9867 26.4081 25.3134 ...
25.9337 26.4729 24.9456 25.5106 25.7396 26.4903 24.9193 ...
25.5061 26.0268 26.5162];

dept = -[ ...
0 -0.0100 -0.0200 -0.0300 -0.0500 -0.0750 -0.1000 ...
-0.1250 -0.1510 -0.2010 -0.2520 -0.3020 -0.4030 -0.5040 ...
-0.6050 -0.7060 -0.8070 -0.9080 -1.0090 -1.1110 -1.2120 ...
-1.3130 -1.4150 -1.5160 -1.7700 -2.0240];

err = [ ...
0.0000 0.0010 0.1720 0  -0.0000  0 0 0.0000 0.1489 ...
0  0 0 0.0000 0.0013 0.2508 0.0123 0.0073 0 0 0 0 ...
0.0153 0.0574 0.0460 0.0111 0.0163 0.0861 0.2234 ...
0.0132 0.0151 0.0205 0.0439 0.0117 0.0026 0.0194 ...
0.2647 0.0144 0.0070 0.0212 0.1154 0.0118 0.0133 ...
0.0972 0.0105 0.0224 0.1203 0.0109 0.0199 0.1679 ...
0.0107 0.0197 0.2927 0.1010 0.0115 0.0220 0.2935 ...
0.0562 0.0104 0.0176];

sal = [ ...
4.355 34.355 34.353 34.289 34.316 34.852 35.298 35.475 35.1470 ...
34.644 34.674 34.729 34.431 34.430 34.429 34.357 34.345 34.3940 ...
35.104 34.900 34.885 34.673 34.727 34.436 34.435 34.435 34.3140 ...
34.289 34.522 34.619 34.590 34.706 34.640 34.675 34.729 34.4000 ...
34.399 34.398 34.420 34.464 34.424 34.608 34.565 34.595 34.6220 ...
34.680 34.731 34.458 34.459 34.481 34.474 34.478 34.581 34.6030 ...
34.573 34.575 34.630 34.694 34.738 34.747 34.743 34.726 34.8730 ...
34.970 35.216 35.481 35.384 35.165 34.668 34.629 34.656 34.5520 ...
34.539 34.528 34.866 35.004 35.294 35.549 35.457 35.099 34.6490 ...
34.630 34.649 34.534 34.535 34.693 34.953 35.010 35.209 35.5870 ...
35.358 35.137 34.634 34.675 34.722 34.547 34.555 34.703 34.8880 ...
35.000 35.368 35.458 35.488 35.178 34.629 34.673 34.720 34.6680 ...
34.667 34.899 34.929 35.155 35.380 35.485 35.262 34.641 34.6800 ...
34.723 34.513 34.516 34.560 34.708 34.883 35.069 35.138 35.2870 ...
35.266 34.634 34.677 34.727 34.521 34.520 34.615 34.919 34.9610 ...
35.224 35.447 35.407 35.376 34.629 34.672 34.721 34.516 34.5180 ...
34.532 34.491 34.804 35.132 35.493 35.484 35.289 34.642 34.6730 ...
34.725 34.412 34.413 34.420 34.611 34.815 35.172 35.374 35.2910 ...
35.210 34.646 34.670 34.724 34.424 34.422 34.353 34.548 34.9120 ...
35.264 35.452 35.370 35.228 34.641 34.677 34.726 34.379 34.3640 ...
34.442 34.925 35.209 35.220 35.348 35.140 34.649 34.677 34.7260 ...
34.7300];

temp = [ ...
25.860 25.8573 25.833 25.3985 24.805 21.075 19.7334 17.2044 ...
13.9558  6.263  3.3977  2.254 26.658 26.6513 26.674 26.0258 ...
25.8661 23.900 18.3863 14.889 12.5443  3.5262  2.2969 26.6687 ...
26.6675 26.664 26.113 25.880 19.8707 16.4565 13.1525 12.0757 ...
 6.2943  3.4493  2.3592 26.837 26.8017 26.7714 26.757 24.0665 ...
17.852 16.2003 13.9757 11.272  6.1974  3.4404  2.3125 26.6097 ...
26.415 18.023 25.6403 23.106 15.1935 14.3076 11.7223 11.0264 ...
 6.0717  3.3423  2.2587 24.7603 24.6769 24.5459 23.855 22.875 ...
19.626 16.9165 15.8377 13.317  8.6463  6.2125  3.7149 24.9016 ...
24.9245 24.7191 23.5608 21.503 20.437 18.075 15.545 12.7148 ...
 8.4392  6.2062  3.9394 25.0887 25.088 24.159 22.2588 21.5005 ...
19.350 17.516 14.771 12.7636  5.666  3.3583  2.2159 24.8752 ...
24.717 24.340 22.6087 22.552 17.8457 17.1725 16.9884 12.999 ...
 5.4603  3.4037  2.3513 24.8183 24.8183 24.373 23.9171 19.6905 ...
17.551 16.122 13.702  5.6301  3.2526  2.2849 25.1686 25.1644 ...
24.641 24.2764 23.5705 21.139 18.231 16.3735 14.124  5.7853 ...
 3.2961  2.1928  NaN 24.843 24.353 23.2607 23.0215 20.175 ...
18.4265 15.872 14.540  5.8682  3.3171  2.2436 25.2201 24.9804 ...
 NaN 24.999 23.8015 20.468 18.7087 16.619 14.059  6.0804 ...
 3.4007  2.2365  NaN 25.0092 24.924 24.393 22.5163 20.119 ...
19.016 16.2088 13.453  5.8616  3.4125  2.2523 25.5314 25.5266 ...
25.177 24.322 22.496 20.0994 18.472 17.2916 13.436  5.9505 ...
 3.3034  2.2158 25.4233 25.1575 24.444 21.894 20.040 17.772 ...
15.994 12.971  5.9799  3.3583  2.3035  2.3035];

atlsal(54,26)=0;
atl = [ ...
3.977 3.944 3.948 3.953 3.974 3.992 4.003 4.053 4.092 4.144 4.195 4.232 4.290 ...
4.348 4.417 4.474 4.522 4.567 4.600 4.615 4.649 4.677 4.698 4.716 4.742 4.762];
atlsal(1,:) = atl;
atl = [ ...
4.040 3.999 4.005 4.010 4.035 4.055 4.063 4.100 4.127 4.135 4.155 4.177 4.226 ...
4.275 4.346 4.408 4.463 4.512 4.552 4.571 4.614 4.653 4.678 4.703 4.744 4.772];
atlsal(2,:) = atl;
atl = [ ...
4.124 4.079 4.087 4.091 4.121 4.146 4.156 4.183 4.198 4.157 4.141 4.144 4.181 ...
4.215 4.281 4.345 4.403 4.454 4.499 4.522 4.573 4.622 4.653 4.684 4.741 4.777];
atlsal(3,:) = atl;
atl = [ ...
4.229 4.185 4.194 4.199 4.234 4.267 4.290 4.307 4.309 4.214 4.160 4.140 4.162 ...
4.175 4.229 4.291 4.348 4.396 4.445 4.473 4.531 4.589 4.625 4.663 4.735 4.780];
atlsal(4,:) = atl;
atl = [ ...
4.359 4.324 4.333 4.337 4.381 4.433 4.480 4.482 4.467 4.310 4.214 4.170 4.172 ...
4.155 4.193 4.248 4.299 4.341 4.392 4.427 4.491 4.556 4.597 4.640 4.726 4.779];
atlsal(5,:) = atl;
atl = [ ...
4.512 4.486 4.494 4.498 4.553 4.630 4.707 4.697 4.665 4.444 4.306 4.236 4.210 ...
4.154 4.172 4.218 4.260 4.293 4.344 4.387 4.454 4.524 4.571 4.619 4.716 4.778];
atlsal(6,:) = atl;
atl = [ ...
4.682 4.666 4.672 4.677 4.740 4.841 4.949 4.929 4.885 4.611 4.435 4.340 4.273 ...
4.169 4.164 4.197 4.230 4.255 4.305 4.352 4.421 4.494 4.548 4.598 4.707 4.776];
atlsal(7,:) = atl;
atl = [ ...
4.854 4.844 4.850 4.855 4.923 5.045 5.182 5.151 5.099 4.788 4.597 4.480 4.361 ...
4.205 4.175 4.194 4.216 4.233 4.276 4.327 4.394 4.463 4.527 4.580 4.698 4.773];
atlsal(8,:) = atl;
atl = [ ...
4.998 4.994 4.999 5.006 5.079 5.204 5.353 5.314 5.259 4.950 4.781 4.650 4.467 ...
4.268 4.211 4.215 4.223 4.233 4.265 4.315 4.375 4.437 4.509 4.563 4.688 4.770];
atlsal(9,:) = atl;
atl = [ ...
5.121 5.124 5.130 5.140 5.213 5.321 5.468 5.428 5.374 5.098 4.957 4.823 4.591 ...
4.346 4.256 4.239 4.233 4.237 4.258 4.308 4.362 4.419 4.493 4.548 4.678 4.765];
atlsal(10,:) = atl;
atl = [ ...
5.228 5.237 5.244 5.256 5.323 5.402 5.534 5.498 5.451 5.226 5.111 4.984 4.726 ...
4.435 4.307 4.264 4.243 4.241 4.255 4.302 4.352 4.406 4.480 4.535 4.668 4.759];
atlsal(11,:) = atl;
atl = [ ...
5.320 5.333 5.340 5.353 5.412 5.466 5.577 5.542 5.499 5.317 5.232 5.120 4.857 ...
4.530 4.364 4.293 4.255 4.247 4.254 4.299 4.347 4.400 4.470 4.525 4.658 4.754];
atlsal(12,:) = atl;
atl = [ ...
5.397 5.414 5.421 5.433 5.481 5.511 5.594 5.560 5.520 5.377 5.317 5.223 4.967 ...
4.620 4.420 4.323 4.270 4.256 4.257 4.300 4.347 4.399 4.465 4.520 4.651 4.751];
atlsal(13,:) = atl;
atl = [ ...
5.468 5.487 5.492 5.502 5.538 5.548 5.601 5.567 5.527 5.413 5.373 5.294 5.049 ...
4.699 4.470 4.351 4.285 4.265 4.263 4.304 4.350 4.403 4.464 4.520 4.648 4.750];
atlsal(14,:) = atl;
atl = [ ...
5.536 5.559 5.561 5.567 5.592 5.588 5.614 5.576 5.531 5.434 5.407 5.337 5.105 ...
4.761 4.512 4.375 4.298 4.275 4.271 4.311 4.356 4.410 4.467 4.525 4.649 4.753];
atlsal(15,:) = atl;
atl = [ ...
5.603 5.629 5.629 5.630 5.647 5.633 5.635 5.591 5.539 5.449 5.426 5.361 5.138 ...
4.808 4.545 4.393 4.308 4.283 4.281 4.321 4.366 4.422 4.476 4.535 4.656 4.759];
atlsal(16,:) = atl;
atl = [ ...
5.671 5.702 5.699 5.697 5.711 5.687 5.671 5.619 5.553 5.464 5.442 5.376 5.156 ...
4.842 4.570 4.408 4.319 4.292 4.291 4.334 4.381 4.439 4.492 4.551 4.669 4.768];
atlsal(17,:) = atl;
atl = [ ...
5.754 5.791 5.788 5.784 5.796 5.760 5.729 5.666 5.584 5.484 5.459 5.388 5.167 ...
4.869 4.591 4.422 4.330 4.302 4.305 4.351 4.402 4.461 4.512 4.573 4.686 4.781];
atlsal(18,:) = atl;
atl = [ ...
5.845 5.889 5.885 5.881 5.891 5.834 5.788 5.720 5.632 5.507 5.468 5.389 5.167 ...
4.890 4.606 4.430 4.336 4.311 4.320 4.370 4.423 4.483 4.533 4.594 4.707 4.798];
atlsal(19,:) = atl;
atl = [ ...
5.956 6.021 6.017 6.017 6.025 5.934 5.878 5.805 5.711 5.540 5.479 5.392 5.167 ...
4.911 4.619 4.439 4.344 4.323 4.335 4.391 4.446 4.506 4.558 4.618 4.731 4.817];
atlsal(20,:) = atl;
atl = [ ...
6.083 6.210 6.209 6.213 6.222 6.082 6.018 5.934 5.821 5.583 5.495 5.400 5.169 ...
4.928 4.634 4.456 4.362 4.343 4.355 4.415 4.474 4.532 4.586 4.650 4.758 4.839];
atlsal(21,:) = atl;
atl = [ ...
6.210 6.403 6.405 6.415 6.423 6.239 6.173 6.076 5.942 5.641 5.520 5.400 5.158 ...
4.924 4.642 4.468 4.377 4.361 4.373 4.439 4.502 4.560 4.616 4.684 4.787 4.861];
atlsal(22,:) = atl;
atl = [ ...
6.357 6.555 6.557 6.570 6.574 6.385 6.318 6.206 6.055 5.712 5.550 5.402 5.146 ...
4.910 4.637 4.465 4.379 4.367 4.384 4.455 4.522 4.583 4.644 4.716 4.817 4.883];
atlsal(23,:) = atl;
atl = [ ...
6.512 6.688 6.686 6.700 6.696 6.524 6.456 6.329 6.165 5.790 5.582 5.407 5.135 ...
4.890 4.624 4.455 4.375 4.368 4.393 4.468 4.539 4.604 4.670 4.749 4.844 4.902];
atlsal(24,:) = atl;
atl = [ ...
6.656 6.808 6.803 6.814 6.801 6.646 6.577 6.440 6.269 5.861 5.608 5.407 5.117 ...
4.864 4.604 4.441 4.370 4.370 4.403 4.481 4.556 4.626 4.696 4.780 4.869 4.918];
atlsal(25,:) = atl;
atl = [...
6.781 6.907 6.902 6.908 6.888 6.746 6.676 6.537 6.363 5.923 5.627 5.401 5.091 ...
4.831 4.578 4.425 4.364 4.373 4.415 4.497 4.575 4.649 4.721 4.808 4.891 4.930];
atlsal(26,:) = atl;
atl = [ ...
6.883 6.981 6.979 6.981 6.955 6.825 6.755 6.620 6.450 5.979 5.640 5.389 5.057 ...
4.793 4.548 4.409 4.359 4.377 4.428 4.513 4.594 4.674 4.748 4.831 4.908 4.938];
atlsal(27,:) = atl;
atl = [ ...
6.966 7.035 7.036 7.035 7.006 6.887 6.817 6.691 6.527 6.026 5.647 5.373 5.020 ...
4.754 4.517 4.395 4.355 4.382 4.442 4.530 4.614 4.699 4.774 4.848 4.920 4.942];
atlsal(28,:) = atl;
atl = [ ...
7.029 7.072 7.076 7.073 7.045 6.934 6.864 6.748 6.591 6.065 5.649 5.355 4.981 ...
4.716 4.487 4.382 4.353 4.388 4.456 4.547 4.633 4.723 4.798 4.861 4.927 4.944];
atlsal(29,:) = atl;
atl = [ ...
7.074 7.095 7.101 7.099 7.072 6.969 6.898 6.793 6.639 6.095 5.646 5.335 4.943 ...
4.679 4.461 4.374 4.355 4.395 4.469 4.562 4.650 4.744 4.818 4.871 4.931 4.942];
atlsal(30,:) = atl;
atl = [ ...
7.099 7.106 7.114 7.114 7.090 6.995 6.922 6.823 6.669 6.112 5.636 5.312 4.906 ...
4.643 4.441 4.369 4.360 4.404 4.481 4.574 4.665 4.760 4.833 4.878 4.932 4.940];
atlsal(31,:) = atl;
atl = [ ...
7.105 7.104 7.114 7.117 7.098 7.012 6.937 6.838 6.678 6.111 5.616 5.283 4.871 ...
4.611 4.427 4.369 4.368 4.413 4.491 4.585 4.677 4.771 4.842 4.882 4.931 4.936];
atlsal(32,:) = atl;
atl = [ ...
7.088 7.085 7.097 7.104 7.090 7.020 6.943 6.839 6.666 6.091 5.583 5.246 4.836 ...
4.582 4.421 4.373 4.377 4.424 4.501 4.593 4.685 4.777 4.846 4.885 4.928 4.933];
atlsal(33,:) = atl;
atl = [ ...
7.047 7.044 7.059 7.069 7.063 7.015 6.941 6.825 6.634 6.047 5.535 5.202 4.802 ...
4.560 4.421 4.382 4.389 4.435 4.509 4.599 4.691 4.779 4.848 4.888 4.924 4.930];
atlsal(34,:) = atl;
atl = [ ...
6.979 6.980 6.995 7.008 7.012 6.995 6.932 6.799 6.582 5.981 5.474 5.150 4.768 ...
4.545 4.428 4.394 4.401 4.446 4.517 4.603 4.694 4.778 4.848 4.890 4.921 4.930];
atlsal(35,:) = atl;
atl = [ ...
6.884 6.889 6.903 6.918 6.934 6.955 6.915 6.761 6.514 5.892 5.400 5.093 4.737 ...
4.537 4.441 4.409 4.414 4.457 4.524 4.607 4.696 4.777 4.849 4.894 4.919 4.931];
atlsal(36,:) = atl;
atl = [ ...
6.768 6.777 6.788 6.803 6.831 6.893 6.888 6.711 6.428 5.784 5.316 5.032 4.709 ...
4.536 4.456 4.425 4.427 4.467 4.530 4.613 4.699 4.777 4.853 4.899 4.922 4.934];
atlsal(37,:) = atl;
atl = [ ...
6.635 6.647 6.655 6.668 6.706 6.809 6.849 6.646 6.326 5.665 5.229 4.972 4.686 ...
4.541 4.472 4.441 4.439 4.476 4.537 4.620 4.705 4.782 4.860 4.907 4.927 4.938];
atlsal(38,:) = atl;
atl = [ ...
6.495 6.507 6.513 6.525 6.567 6.703 6.790 6.559 6.205 5.540 5.143 4.918 4.672 ...
4.550 4.486 4.454 4.451 4.484 4.544 4.629 4.715 4.790 4.868 4.914 4.935 4.942];
atlsal(39,:) = atl;
atl = [ ...
6.354 6.364 6.371 6.382 6.425 6.581 6.703 6.444 6.066 5.419 5.066 4.874 4.666 ...
4.561 4.497 4.464 4.461 4.492 4.550 4.639 4.727 4.802 4.878 4.921 4.942 4.947];
atlsal(40,:) = atl;
atl = [ ...
6.218 6.227 6.236 6.249 6.291 6.450 6.584 6.298 5.912 5.308 5.005 4.844 4.668 ...
4.571 4.504 4.470 4.469 4.498 4.557 4.648 4.740 4.814 4.886 4.926 4.949 4.950];
atlsal(41,:) = atl;
atl = [ ...
6.097 6.105 6.119 6.136 6.177 6.320 6.435 6.128 5.754 5.220 4.968 4.832 4.677 ...
4.579 4.506 4.472 4.474 4.504 4.563 4.657 4.751 4.826 4.894 4.929 4.954 4.954];
atlsal(42,:) = atl;
atl = [ ...
5.999 6.007 6.027 6.049 6.092 6.205 6.266 5.948 5.607 5.160 4.957 4.838 4.691 ...
4.585 4.506 4.472 4.477 4.510 4.570 4.665 4.760 4.836 4.899 4.932 4.957 4.957];
atlsal(43,:) = atl;
atl = [ ...
5.929 5.940 5.966 5.994 6.041 6.114 6.099 5.782 5.486 5.130 4.970 4.862 4.708 ...
4.588 4.504 4.472 4.479 4.517 4.578 4.673 4.767 4.843 4.903 4.934 4.959 4.959];
atlsal(44,:) = atl;
atl = [ ...
5.889 5.905 5.934 5.968 6.019 6.053 5.957 5.651 5.401 5.128 4.999 4.894 4.722 ...
4.589 4.503 4.473 4.482 4.525 4.588 4.683 4.774 4.849 4.906 4.935 4.960 4.962];
atlsal(45,:) = atl;
atl = [ ...
5.873 5.893 5.926 5.962 6.018 6.022 5.855 5.566 5.355 5.145 5.035 4.928 4.733 ...
4.589 4.504 4.476 4.487 4.534 4.598 4.695 4.782 4.855 4.909 4.937 4.962 4.963];
atlsal(46,:) = atl;
atl = [ ...
5.871 5.892 5.925 5.964 6.024 6.010 5.796 5.524 5.342 5.171 5.071 4.958 4.739 ...
4.588 4.506 4.481 4.493 4.542 4.609 4.706 4.790 4.859 4.911 4.939 4.964 4.964];
atlsal(47,:) = atl;
atl = [ ...
5.868 5.888 5.920 5.959 6.024 6.004 5.769 5.513 5.348 5.199 5.100 4.980 4.743 ...
4.589 4.511 4.488 4.501 4.549 4.618 4.716 4.797 4.864 4.913 4.941 4.966 4.964];
atlsal(48,:) = atl;
atl = [ ...
5.850 5.870 5.899 5.939 6.012 5.993 5.759 5.517 5.364 5.223 5.123 4.997 4.748 ...
4.593 4.516 4.497 4.509 4.555 4.626 4.723 4.804 4.868 4.915 4.943 4.966 4.963];
atlsal(49,:) = atl;
atl = [ ...
5.750 5.774 5.801 5.853 5.951 5.938 5.747 5.530 5.387 5.246 5.142 5.014 4.767 ...
4.611 4.533 4.514 4.524 4.564 4.635 4.728 4.810 4.872 4.915 4.943 4.964 4.959];
atlsal(50,:) = atl;
atl = [ ...
5.679 5.708 5.737 5.800 5.915 5.903 5.738 5.529 5.387 5.242 5.138 5.015 4.778 ...
4.625 4.544 4.523 4.531 4.568 4.638 4.728 4.811 4.873 4.914 4.942 4.963 4.957];
atlsal(51,:) = atl;
atl = [ ...
5.616 5.650 5.683 5.759 5.886 5.873 5.728 5.520 5.377 5.229 5.123 5.008 4.789 ...
4.642 4.557 4.534 4.539 4.572 4.639 4.726 4.810 4.872 4.912 4.940 4.963 4.955];
atlsal(52,:) = atl;
atl = [ ...
5.579 5.615 5.654 5.741 5.871 5.850 5.715 5.503 5.356 5.205 5.100 4.993 4.797 ...
4.662 4.574 4.546 4.547 4.578 4.642 4.726 4.810 4.872 4.911 4.939 4.963 4.953];
atlsal(53,:) = atl;
atl = [ ...
5.580 5.615 5.659 5.749 5.868 5.831 5.693 5.474 5.325 5.173 5.069 4.974 4.806 ...
4.687 4.596 4.562 4.560 4.588 4.647 4.729 4.813 4.874 4.912 4.939 4.964 4.952];
atlsal(54,:) = atl;
atlsal=30 + atlsal';
figure('Color',[0.2 0.6 0.8],'MenuBar','none', ...
	'Name','OMP Analysis version 2.0', ...
	'NumberTitle','off','Position',[10 20 600 420],'Resize','off');

axes('Position',[0.1 0.53 0.1 0.2],'color',[1 1 1],'Box','on', ...
	'units','normalized','ylim',[24.5 27],'fontname','helvetica', ...
	'fontsize',fts,'xcol','w','ycol','w');
hold on
plot(100*err,dens,'k.')
axis ij
title('mass conservation','color','w')
xlabel('residual (%)','Color','w','fontname','helvetica','fontsize',fts)
ylabel('sigma-t','Color','w','fontname','helvetica','fontsize',fts)
hold off

axes('Position',[0.1 0.23 0.27 0.2],'Color',[0 0 0],'Box','on', ...
	'Units','normalized','xlim',[min(atllat) max(atllat)],'ylim', ...
	[min(dept) max(dept)], ...
	'xColor','w','yColor','w','fontname','helvetica','fontsize',fts)
hold on
pcolor(atllat,dept,atlsal)
axis ij
colormap(hsv)
shading flat
caxis([34 36.9])
xlabel('latitude (deg.)','fontname','helvetica','fontsize',fts)
ylabel('depth (km)','fontname','helvetica','fontsize',fts,'color','w')
text(-35,2.8,'Atlantic Ocean: salinity','fontname','helvetica','fontsize',fts,'color','w')
hold off

axes('Position',[0.27 0.53 0.12 0.2],'Color',[0 0 0],'Box','on', ...
   'TickDir','out','Units','normalized','xlim',[34.2 35.6],'ylim', ...
     [0 30],'xColor','w','yColor','w', ...
	'fontname','helvetica','fontsize',fts)
hold on
plot(sal,temp,'.r')
title('Indian Ocean','color','w')
ylabel('temperature','fontname','helvetica','fontsize',fts,'color','w')
xlabel('salinity','fontname','helvetica','fontsize',fts,'color','w')
hold off
set(gca,'fontname','helvetica','fontsize',fts,'color','w')
for i = 1:4
tx2 = uicontrol('Units','normalized', ...
	'BackgroundColor',[0.2 0.2 0.2], ...
	'ForegroundColor',[1 1 1], ...
	'Position',[0.0 1-0.035*i 1.0 0.05], ...
	'HorizontalAlignment','center', ...
	'String',ht3(i,:), ...
	'Style','text','fontsize',fts+1);
end

graphmode = uicontrol('Units','normalized', ...
	'BackgroundColor',[1 0.8 0.5], ...
	'Callback',[	'clear atllat atlsal dens dept err sal temp,' ...
	'omp2gui'], ...
	'Position',[0.23 0.05 0.2 0.066], ...
	'String','interactive (GUI)', ...
	'Style','pushbutton');
	
intermode = uicontrol('Units','normalized', ...
	'BackgroundColor',[1 0.8 0.5], ...
	'Callback',['clear atllat atlsal dens dept err sal temp,' ...
	'omp2int'], ...
	'Position',[0.02 0.05 0.2 0.066], ...
	'String','interactive (listing)', ...
	'Style','pushbutton');

automode = uicontrol('Units','normalized', ...
	'BackgroundColor',[1 0.8 0.5], ...
	'Callback',[ ...
	'clear atllat atlsal dens dept err sal temp,' ...
	'set(intermode,''Visible'',''off''), set(automode,''Visible'',''off''),' ...
	'set(infile,''Visible'',''on''), set(graphmode,''Visible'',''off''),' ...
	'set(whichfile,''Visible'',''on'');'], ...
	'Position',[0.44 0.05 0.2 0.066], ...
	'String','automatic (file)', ...
	'Style','pushbutton');

ax = axes('position',[0.455 0.12 1 0.71],'color',[0.85 0.95 0.95], ...
	'xcolor',[0.7 0.83 0.8],'ycolor',[0.7 0.83 0.8],'xtick',[],'ytick',[]);
hold on
for i = 1:9
	text(0.02,1-0.05*i,ht1(i,:),'color','k','fontname',eval(ftm),'fontsize',ftz);
end

for i = 1:6
	text(0.02,0.53-0.05*i,ht2(i,:),'color','k','fontname',eval(ftm),'fontsize',ftz);
end

ex = uicontrol('Units','normalized', ...
	'BackgroundColor',[0.9 0.9 0.2], ...
	'Callback',['clear all, close all'], ...
	'Position',[0.9 0.05 0.066 0.066], ...
	'String','exit', ...
	'Style','pushbutton');
	
hlp = uicontrol('Units','normalized', ...
	'BackgroundColor',[0.9 0.9 0.2], ...
	'Callback','helpomp', ...
	'Position',[0.82 0.05 0.066 0.066], ...
	'String','help', ...
	'Style','pushbutton');
	
cr = uicontrol('Units','normalized', ...
	'BackgroundColor',[1 0.4 0.2], ...
	'Callback',['crf = figure(''Color'',[0.5 0.6 0.8],''MenuBar'',''none'','...
		'''Name'',''OMP Analysis: Credits'',' ...
		'''Position'',[10 20 600 420],''NumberTitle'',''off'',''Resize'',''off'');' ...
		'displtxt(credit);', ...
		'pause(5),close(crf),' ...
		], ...
	'Position',[0.69 0.05 0.116 0.066], ...
	'String','credits', ...
	'Style','pushbutton');

infile = uicontrol('Units','normalized', ...
	'BackgroundColor',[1 1 1], ...
	'Callback',[ ...
	'newfile = get(infile,''String'');,' ...
	'if exist(newfile) == 0,' ...
	'set(infile,''String'','' file not found''),' ...
	'else,' ...
		'set(infile,''Visible'',''off'');,' ...
		'set(whichfile,''String'',''Reading parameters'');,' ...
		'omp2auto;' ...
	'end'], ...
	'Position',[0.23 0.05 0.21 0.05], ...
	'String','incontr2', ...
	'Style','edit');

whichfile = uicontrol('Units','normalized', ...
	'BackgroundColor',[1 0.9 0.9], ...
	'Callback','omp2int', ...
	'Position',[0.02 0.05 0.18 0.05], ...
	'String','Enter control file:', ...
	'Style','text');
	
set(infile,'Visible','off');
set(whichfile,'Visible','off');
